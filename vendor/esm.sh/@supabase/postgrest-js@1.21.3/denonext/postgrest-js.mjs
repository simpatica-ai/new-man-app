/* esm.sh - @supabase/postgrest-js@1.21.3 */
import*as __0$ from"/@supabase/node-fetch@^2.6.14?target=denonext";var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({__esModule:true},m);switch(n){case"@supabase/node-fetch":return c(__0$);default:console.error('module "'+n+'" not found');return null;}};
var X=Object.create;var G=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var ee=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty;var se=(s=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(s,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):s)(function(s){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+s+'" is not supported')});var p=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var re=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Z(e))!te.call(s,i)&&i!==t&&G(s,i,{get:()=>e[i],enumerable:!(r=Y(e,i))||r.enumerable});return s};var ie=(s,e,t)=>(t=s!=null?X(ee(s)):{},re(e||!s||!s.__esModule?G(t,"default",{value:s,enumerable:!0}):t,s));var S=p(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var k=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};B.default=k});var E=p($=>{"use strict";var R=$&&$.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty($,"__esModule",{value:!0});var ae=R(se("@supabase/node-fetch")),ne=R(S()),T=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ae.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");let r=this.fetch,i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var n,h,u,c;let l=null,o=null,f=null,P=a.status,g=a.statusText;if(a.ok){if(this.method!=="HEAD"){let b=await a.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((n=this.headers.get("Accept"))===null||n===void 0)&&n.includes("application/vnd.pgrst.plan+text"))?o=b:o=JSON.parse(b))}let _=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),O=(u=a.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");_&&O&&O.length>1&&(f=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,f=null,P=406,g="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{let _=await a.text();try{l=JSON.parse(_),Array.isArray(l)&&a.status===404&&(o=[],l=null,P=200,g="OK")}catch{a.status===404&&_===""?(P=204,g="No Content"):l={message:_}}if(l&&this.isMaybeSingle&&(!((c=l?.details)===null||c===void 0)&&c.includes("0 rows"))&&(l=null,P=200,g="OK"),l&&this.shouldThrowOnError)throw new ne.default(l)}return{error:l,data:o,count:f,status:P,statusText:g}});return this.shouldThrowOnError||(i=i.catch(a=>{var n,h,u;return{error:{message:`${(n=a?.name)!==null&&n!==void 0?n:"FetchError"}: ${a?.message}`,details:`${(h=a?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(u=a?.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};$.default=T});var D=p(y=>{"use strict";var he=y&&y.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(y,"__esModule",{value:!0});var le=he(E()),M=class extends le.default{select(e){let t=!1,r=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:a=i}={}){let n=a?`${a}.order`:"order",h=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${h?`${h},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){let a=typeof i>"u"?"offset":`${i}.offset`,n=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(n,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:a=!1,format:n="text"}={}){var h;let u=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${c}"; options=${u};`),n==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};y.default=M});var q=p(v=>{"use strict";var ue=v&&v.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(v,"__esModule",{value:!0});var oe=ue(D()),H=class extends oe.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");let n=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};v.default=H});var N=p(A=>{"use strict";var de=A&&A.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(A,"__esModule",{value:!0});var j=de(q()),C=class{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){let i=t?"HEAD":"GET",a=!1,n=(e??"*").split("").map(h=>/\s/.test(h)&&!a?"":(h==='"'&&(a=!a),h)).join("");return this.url.searchParams.set("select",n),r&&this.headers.append("Prefer",`count=${r}`),new j.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var i;let a="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let n=e.reduce((h,u)=>h.concat(Object.keys(u)),[]);if(n.length>0){let h=[...new Set(n)].map(u=>`"${u}"`);this.url.searchParams.set("columns",h.join(","))}}return new j.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:a=!0}={}){var n;let h="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let u=e.reduce((c,l)=>c.concat(Object.keys(l)),[]);if(u.length>0){let c=[...new Set(u)].map(l=>`"${l}"`);this.url.searchParams.set("columns",c.join(","))}}return new j.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}update(e,{count:t}={}){var r;let i="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new j.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;let r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new j.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};A.default=C});var J=p(w=>{"use strict";var F=w&&w.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(w,"__esModule",{value:!0});var ce=F(N()),fe=F(q()),x=class s{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=i}from(e){let t=new URL(`${this.url}/${e}`);return new ce.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new s(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:a}={}){var n;let h,u=new URL(`${this.url}/rpc/${e}`),c;r||i?(h=r?"HEAD":"GET",Object.entries(t).filter(([o,f])=>f!==void 0).map(([o,f])=>[o,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([o,f])=>{u.searchParams.append(o,f)})):(h="POST",c=t);let l=new Headers(this.headers);return a&&l.set("Prefer",`count=${a}`),new fe.default({method:h,url:u,headers:l,schema:this.schemaName,body:c,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};w.default=x});var V=p(d=>{"use strict";var m=d&&d.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(d,"__esModule",{value:!0});d.PostgrestError=d.PostgrestBuilder=d.PostgrestTransformBuilder=d.PostgrestFilterBuilder=d.PostgrestQueryBuilder=d.PostgrestClient=void 0;var L=m(J());d.PostgrestClient=L.default;var Q=m(N());d.PostgrestQueryBuilder=Q.default;var K=m(q());d.PostgrestFilterBuilder=K.default;var U=m(D());d.PostgrestTransformBuilder=U.default;var z=m(E());d.PostgrestBuilder=z.default;var I=m(S());d.PostgrestError=I.default;d.default={PostgrestClient:L.default,PostgrestQueryBuilder:Q.default,PostgrestFilterBuilder:K.default,PostgrestTransformBuilder:U.default,PostgrestBuilder:z.default,PostgrestError:I.default}});var W=ie(V(),1),{PostgrestClient:pe,PostgrestQueryBuilder:me,PostgrestFilterBuilder:Pe,PostgrestTransformBuilder:ge,PostgrestBuilder:_e,PostgrestError:$e}=W.default;var Be={PostgrestClient:pe,PostgrestQueryBuilder:me,PostgrestFilterBuilder:Pe,PostgrestTransformBuilder:ge,PostgrestBuilder:_e,PostgrestError:$e};export{_e as PostgrestBuilder,pe as PostgrestClient,$e as PostgrestError,Pe as PostgrestFilterBuilder,me as PostgrestQueryBuilder,ge as PostgrestTransformBuilder,Be as default};
//# sourceMappingURL=postgrest-js.mjs.map